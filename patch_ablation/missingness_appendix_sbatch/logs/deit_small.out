Namespace(arch='deit_tiny_resnet_aug', out_dir='missingness_results/patch_16_0_0_0/deit_tiny_resnet_aug', saliency_map_pkl='/mnt/nfs/home/saachij/src/CausalDomainTransfer/patch_ablation/missingness_results/saliency_maps/resnet_50_sal_map.pkl', methods=['Saliency_reverse', 'Saliency'], model_path=None, ablation_patch_size=16, filler_values=[0.0, 0.0, 0.0], superpixel=False, skip_random=False, superpixel_pkl=None, image_net_cache_file=None, skip_factor=2, superpixel_type='patches', use_missingness=True)
length of DS 10000
/mnt/nfs/home/hadi/src/missingness/CausalDomainTransfer/run/imagenet/deittiny_resnetaug/model_best.pth
torchvision models: 
 ['alexnet', 'densenet121', 'densenet161', 'densenet169', 'densenet201', 'googlenet', 'inception_v3', 'mnasnet0_5', 'mnasnet0_75', 'mnasnet1_0', 'mnasnet1_3', 'mobilenet_v2', 'mobilenet_v3_large', 'mobilenet_v3_small', 'resnet101', 'resnet152', 'resnet18', 'resnet34', 'resnet50', 'resnext101_32x8d', 'resnext50_32x4d', 'shufflenet_v2_x0_5', 'shufflenet_v2_x1_0', 'shufflenet_v2_x1_5', 'shufflenet_v2_x2_0', 'squeezenet1_0', 'squeezenet1_1', 'vgg11', 'vgg11_bn', 'vgg13', 'vgg13_bn', 'vgg16', 'vgg16_bn', 'vgg19', 'vgg19_bn', 'wide_resnet101_2', 'wide_resnet50_2']
customized models: 
 ['mylinear', 'myvgg', 'myresnet18', 'myresnet50', 'mypreactresnet18', 'mylenet', 'mydensenet121', 'mymobilenet', 'mymobilenet2', 'mydpn92', 'myshufflenet', 'mysenet18', 'mysresnet18', 'mysresnet50']
Vision Transformer models: 
 ['vit_small_patch16_224', 'vit_base_patch16_224', 'vit_base_patch16_384', 'vit_base_patch32_384', 'vit_large_patch16_224', 'vit_large_patch16_384', 'vit_large_patch32_384', 'vit_huge_patch16_224', 'vit_huge_patch32_384', 'deit_tiny_patch16_224', 'deit_small_patch16_224', 'deit_base_patch16_224', 'deit_base_patch16_384', 'deit_tiny_patch4_32', 'deit_small_patch4_32', 'deit_base_patch4_32']
Invariant Vision Transformer models: 
 ['invariant_vit_small_patch16_224', 'invariant_vit_base_patch16_224']
==> Building model..
CUDA available: True
Device count: 1
GeForce RTX 2080 Ti
deep-gpu-10             Tue Oct  5 00:40:41 2021  460.91.03
[0] GeForce RTX 2080 Ti | 74'C,  81 % |  7002 / 11019 MB | spark(6999M)
[1] GeForce RTX 2080 Ti | 46'C,   4 % |  1252 / 11019 MB | saachij(1249M)
[2] GeForce RTX 2080 Ti | 82'C,  82 % |  7002 / 11019 MB | spark(6999M)
[3] GeForce RTX 2080 Ti | 71'C,  81 % |  7002 / 11019 MB | spark(6999M)
[4] GeForce RTX 2080 Ti | 48'C,   0 % |  5972 / 11019 MB | saachij(5969M)
[5] GeForce RTX 2080 Ti | 80'C,  85 % |  7002 / 11019 MB | spark(6999M)
[6] GeForce RTX 2080 Ti | 70'C,  64 % |  8660 / 11019 MB | saachij(8657M)
[7] GeForce RTX 2080 Ti | 70'C,  55 % |  6966 / 11019 MB | saachij(6963M)
Used by pytorch: 0.00 GB / 11.55 GB
batch 0 method random
0
20
40
60
80
100
120
140
160
180
batch 1 method random
0
20
40
60
80
100
120
140
160
180
batch 2 method random
0
20
40
60
80
100
120
140
160
180
batch 3 method random
0
20
40
60
80
100
120
140
160
180
batch 4 method random
0
20
40
60
80
100
120
140
160
180
batch 5 method random
0
20
40
60
80
100
120
140
160
180
batch 6 method random
0
20
40
60
80
100
120
140
160
180
batch 7 method random
0
20
40
60
80
100
120
140
160
180
batch 8 method random
0
20
40
60
80
100
120
140
160
180
batch 9 method random
0
20
40
60
80
100
120
140
160
180
batch 10 method random
0
20
40
60
80
100
120
140
160
180
batch 11 method random
0
20
40
60
80
100
120
140
160
180
batch 12 method random
0
20
40
60
80
100
120
140
160
180
batch 13 method random
0
20
40
60
80
100
120
140
160
180
batch 14 method random
0
20
40
60
80
100
120
140
160
180
batch 15 method random
0
20
40
60
80
100
120
140
160
180
batch 16 method random
0
20
40
60
80
100
120
140
160
180
batch 17 method random
0
20
40
60
80
100
120
140
160
180
batch 18 method random
0
20
40
60
80
100
120
140
160
180
batch 19 method random
0
20
40
60
80
100
120
140
160
180
batch 0 method Saliency_reverse
0
20
40
60
80
100
120
140
160
180
batch 1 method Saliency_reverse
0
20
40
60
80
100
120
140
160
180
batch 2 method Saliency_reverse
0
20
40
60
80
100
120
140
160
180
batch 3 method Saliency_reverse
0
20
40
60
80
100
120
140
160
180
batch 4 method Saliency_reverse
0
20
40
60
80
100
120
140
160
180
batch 5 method Saliency_reverse
0
20
40
60
80
100
120
140
160
180
batch 6 method Saliency_reverse
0
20
40
60
80
100
120
140
160
180
batch 7 method Saliency_reverse
0
20
40
60
80
100
120
140
160
180
batch 8 method Saliency_reverse
0
20
40
60
80
100
120
140
160
180
batch 9 method Saliency_reverse
0
20
40
60
80
100
120
140
160
180
batch 10 method Saliency_reverse
0
20
40
60
80
100
120
140
160
180
batch 11 method Saliency_reverse
0
20
40
60
80
100
120
140
160
180
batch 12 method Saliency_reverse
0
20
40
60
80
100
120
140
160
180
batch 13 method Saliency_reverse
0
20
40
60
80
100
120
140
160
180
batch 14 method Saliency_reverse
0
20
40
60
80
100
120
140
160
180
batch 15 method Saliency_reverse
0
20
40
60
80
100
120
140
160
180
batch 16 method Saliency_reverse
0
20
40
60
80
100
120
140
160
180
batch 17 method Saliency_reverse
0
20
40
60
80
100
120
140
160
180
batch 18 method Saliency_reverse
0
20
40
60
80
100
120
140
160
180
batch 19 method Saliency_reverse
0
20
40
60
80
100
120
140
160
180
batch 0 method Saliency
0
20
40
60
80
100
120
140
160
180
batch 1 method Saliency
0
20
40
60
80
100
120
140
160
180
batch 2 method Saliency
0
20
40
60
80
100
120
140
160
180
batch 3 method Saliency
0
20
40
60
80
100
120
140
160
180
batch 4 method Saliency
0
20
40
60
80
100
120
140
160
180
batch 5 method Saliency
0
20
40
60
80
100
120
140
160
180
batch 6 method Saliency
0
20
40
60
80
100
120
140
160
180
batch 7 method Saliency
0
20
40
60
80
100
120
140
160
180
batch 8 method Saliency
0
20
40
60
80
100
120
140
160
180
batch 9 method Saliency
0
20
40
60
80
100
120
140
160
180
batch 10 method Saliency
0
20
40
60
80
100
120
140
160
180
batch 11 method Saliency
0
20
40
60
80
100
120
140
160
180
batch 12 method Saliency
0
20
40
60
80
100
120
140
160
180
batch 13 method Saliency
0
20
40
60
80
100
120
140
160
180
batch 14 method Saliency
0
20
40
60
80
100
120
140
160
180
batch 15 method Saliency
0
20
40
60
80
100
120
140
160
180
batch 16 method Saliency
0
20
40
60
80
100
120
140
160
180
batch 17 method Saliency
0
20
40
60
80
100
120
140
160
180
batch 18 method Saliency
0
20
40
60
80
100
120
140
160
180
batch 19 method Saliency
0
20
40
60
80
100
120
140
160
180
